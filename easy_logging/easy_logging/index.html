<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>index (easy_logging.index)</title><link rel="stylesheet" href="../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">easy_logging</a> &#x00BB; index</nav></header><h1 id="easy-logging"><a href="#easy-logging" class="anchor"></a>Easy logging</h1><p>Logging infrastructure inspired by the Python logging module. The aim of this module is to provide a quick and easy to use logging infrastructure.</p><p>It has the following features :</p><ul><li>one line logger creation</li><li>log messages are either <code>string</code> or <code>string lazy_t</code></li><li>log level adaptable at runtime from anywhere in the program</li><li>handlers associated to each logger will format and treat the message independantly</li><li>use the infrastructure with your own handlers with the <code>MakeLogging</code> functor.</li></ul><h4 id="basic-example"><a href="#basic-example" class="anchor"></a>Basic example</h4><pre><code class="ml">open Easy_logging
logger = Logging.make_logger &quot;my_logger&quot; (Some Debug) [Cli Debug];;
logger#info &quot;log_message&quot;;; </code></pre><p>will output to the stdout a message of the form</p><pre>1.306  my_logger    Info    log_message</pre><h2 id="index"><a href="#index" class="anchor"></a>Index</h2><ol><li><a href="index.html#description"><span>Overall description</span></a> (<a href="Easy_logging/index.html"><code>Easy_logging</code></a>)</li><li><p><a href="index.html#defaults"><span>Defaults</span></a></p><ol><li><a href="index.html#defaulthandlers"><span>Default Handlers</span></a> ( <a href="Easy_logging__Default_handlers/index.html"><code>Easy_logging__Default_handlers</code></a>)</li><li><a href="index.html#logger"><span>Loggers</span></a> ( <a href="Easy_logging/Logging/class-logger/index.html"><code>Easy_logging.Logging.logger</code></a> )</li><li><a href="index.html#logging"><span>The Logging module</span></a> (<a href="Easy_logging/Logging/index.html"><code>Easy_logging.Logging</code></a>)</li></ol></li><li><a href="index.html#makelogging"><span>The MakeLogging functor</span></a> ( <a href="Easy_logging/MakeLogging/index.html"><code>Easy_logging.MakeLogging</code></a> )</li><li><a href="examples.html">Examples</a></li></ol><h2 id="description"><a href="#description" class="anchor"></a>Overall description</h2><h4 id="infrastructure"><a href="#infrastructure" class="anchor"></a>Infrastructure</h4><p>Like in the python logging module, this logging infrastructure is based on three concepts:</p><p><em>loggers, handlers</em> and <em>log items</em>.</p><p>A call to <em>logger</em> will create a <em>log item</em>, which it will pass to its <em>handlers</em>. Each <em>handler</em> will treats the <em>item</em> (e.g. transform it to a string, and then outputs to stdout or to a file).</p><pre>                                   ___________
                                  | handler 1 |
             _______________      |-----------|
            |     logger    | ==&gt; |   ( * )   |
            |---------------|     |___________|
message ==&gt; | -&gt; log item   |      ___________
            [_______________| ==&gt; | handler 2 |
                                  |   ...     |</pre><h4 id="levels"><a href="#levels" class="anchor"></a>Levels</h4><p>To each logger and log message are associated a level, which will be used to filter the messages going through the logging infrastructure.</p><p>The predefined levels are, in increasing order of precedence :</p><ol><li>Debug : used for debugging.</li><li>Info : used to trace program execution.</li><li>Warning : used for warnings.</li><li>Error : used for errors.</li><li>Flash : used for one-shot debugging: displays an easy to spot message.</li></ol><h4 id="log-items"><a href="#log-items" class="anchor"></a>Log items</h4><p>A log item has type</p><pre><code class="ml">type log_item = {
    level : level;
    logger_name : string;
    msg : string;
    tags : tag list
  } </code></pre><p>where the <code>tag</code> type if defined by the <code>Handlers</code> module.</p><h2 id="defaults"><a href="#defaults" class="anchor"></a>Defaults</h2><h3 id="defaulthandlers"><a href="#defaulthandlers" class="anchor"></a>Default Handlers</h3><p>By default, two handlers are provided. They are instantiated with a level of their own to filter messages :</p><ul><li><p>Cli handler: outputs colored messages to stdout.</p><pre><code class="ml">let h = Default_handlers.make (Cli Debug) </code></pre></li><li><p>File handler : outputs messages to a given file.</p><pre><code class="ml">let h = Default_handlers.make (File (&quot;filename&quot;, Debug)) </code></pre></li></ul><p>Note that file handlers will write to files in the <code>logs</code> folder in the current path, creating it if it doesn't exist. See more about default handlers at <a href="Easy_logging__Default_handlers/index.html"><code>Easy_logging__Default_handlers</code></a>.</p><h3 id="logger"><a href="#logger" class="anchor"></a>Loggers</h3><p>See complete class documentation at <a href="Easy_logging/Logging/class-logger/index.html"><code>Easy_logging.Logging.logger</code></a></p><h4 id="creation"><a href="#creation" class="anchor"></a>Creation</h4><p>A logger object can be created directly :</p><pre><code class="ml">let logger1 = new Logging.logger &quot;my_logger1&quot; (Some Warning) [Cli Debug] </code></pre><p>or through the make_logger function :</p><pre><code class="ml">let logger2 = Logging.make_logger &quot;my_logger2&quot; (Some Debug) [Cli Debug] </code></pre><p>The <code>make_logger</code> function will register the logger instance internaly so that it will be possible to access and modify it from anywhere in the program.</p><h4 id="usage"><a href="#usage" class="anchor"></a>Usage</h4><p>A logger object has two methods for each of the log levels: one that takes a <code>string</code>, and one that takes a <code>string lazy_t</code>.</p><pre><code class="ml">logger1#debug &quot;x is alive&quot;;
logger1#ldebug (lazy (heavy_calculation ())); </code></pre><h3 id="logging"><a href="#logging" class="anchor"></a>The Logging module</h3><p>The <a href="Easy_logging/Logging/index.html"><code>Easy_logging.Logging</code></a> module is that application of <code>MakeLogging</code> over <code>DefaultHandlers</code>. It provides three functions :</p><ul><li><pre><code class="ml">val make_logger :
   string -&gt; log_level option -&gt; Default_handlers.desc list </code></pre><p>to instantiate and register a logger</p></li><li><pre><code class="ml">val set_level : string -&gt; log_level option -&gt; unit</code></pre><p><code>set_level prefix level</code> sets the level of all registered loggers whose name begins by <code>prefix</code> to <code>level</code>.</p></li><li><pre><code class="ml">val get_logger : string -&gt; logger </code></pre><p>Returns a registered logger.</p></li></ul><h2 id="makelogging"><a href="#makelogging" class="anchor"></a>The MakeLogging functor</h2><p>The MakeLogging functor takes a <a href="Easy_logging__/Easy_logging_types/module-type-HandlersT/index.html"><code>Easy_logging__.Easy_logging_types.HandlersT</code></a> typed module, and creates a Logging module.</p><h3 id="warning"><a href="#warning" class="anchor"></a>WARNING</h3><p>When declaring your Handlers module, do not give it the type <code>HandlersT</code>, because then its internal types <code>t</code> and <code>desc</code> won't be accessible.</p><h3 id="example"><a href="#example" class="anchor"></a>Example</h3><p>Here is a very simple example :</p><pre><code class="ml">module MyHandlers =
  struct
    type t = string -&gt; unit
    type desc = string list ref
    let set_formatter _ _ = ()
    let set_level _ _ = ()
    let apply h (item : log_item) = h item.msg
    let make (_internal : desc) =

      fun s -&gt; _internal := s::!_internal
  end

module MyLogging = MakeLogging(MyHandlers)

let l = ref [];;
let mylogger = MyLogging.make_logger &quot;mylogger&quot; (Some Debug) [l];;
mylogger#info &quot;this is a message&quot;;</code></pre></div></body></html>