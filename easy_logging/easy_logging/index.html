<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>index (easy_logging.index)</title><link rel="stylesheet" href="../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ easy_logging</nav><h1 id="top"><a href="#top" class="anchor"></a>easy_logging</h1><nav class="toc"><ul><li><a href="#easy-logging">Easy logging</a><ul><li><a href="#basic-example">Basic example</a></li><li><a href="#table-of-contents">Table of contents</a></li><li><a href="#description">Overall description</a><ul><li><a href="#logging-tree">Logging tree</a><ul><li><a href="#example">Example</a></li></ul></li><li><a href="#levels">Levels</a></li><li><a href="#log-items">Log items</a></li></ul></li><li><a href="#handlers">Handlers</a></li><li><a href="#logger">Loggers</a><ul><li><a href="#creation">Creation</a></li><li><a href="#usage">Usage</a></li></ul></li><li><a href="#logging">The Logging module</a></li><li><a href="#makelogging">The MakeLogging functor</a><ul><li><a href="#warning">WARNING</a></li></ul></li><li><a href="#examples">Examples</a></li><li><a href="#index">Index of modules</a></li></ul></li></ul></nav></header><h2 id="easy-logging"><a href="#easy-logging" class="anchor"></a>Easy logging</h2><p>Logging library inspired by the Python logging module.</p><p>Easy_logging allows fine-grained tuning of of when and where and how log messages are printed, with relatively low configuration, and simple logger configuration and usage.</p><p>It has the following features :</p><ul><li>one line logger creation</li><li>log messages printf style, or provide <code>string</code> or <code>string lazy_t</code> message</li><li>loggers for tree architecture for easy level and handlers configuration</li><li>handlers associated to each logger will filter, format and treat the message independantly</li><li>use tags and tag generators to add contextual information to log messages</li><li>use default handlers for outputing log messages to stdout, stderr or to a file</li><li>declare your own handler for anything else</li></ul><h5 id="basic-example"><a href="#basic-example" class="anchor"></a>Basic example</h5><pre><code class="ml">open Easy_logging
logger = Logging.make_logger &quot;my_logger&quot; (Some Debug) [Cli Debug]
logger#info &quot;log_message&quot; </code></pre><p>will output to the stdout a message of the form</p><pre>1.306  my_logger    Info    log_message</pre><h3 id="table-of-contents"><a href="#table-of-contents" class="anchor"></a>Table of contents</h3><ol><li><a href="index.html#description"><span>Overall description</span></a> (see also <a href="Easy_logging/index.html"><code>Easy_logging</code></a>)</li><li><p><code>defaults</code></p><ol><li><a href="index.html#handlers"><span>Handlers</span></a> (see also <a href="Easy_logging__Handlers/index.html"><code>Easy_logging__Handlers</code></a>)</li><li><a href="index.html#logger"><span>Loggers</span></a> (see also <a href="Easy_logging/Logging/class-logger/index.html"><code>Easy_logging.Logging.logger</code></a> )</li><li><a href="index.html#logging"><span>The Logging module</span></a> (see also <a href="Easy_logging/Logging/index.html"><code>Easy_logging.Logging</code></a>)</li></ol></li><li><a href="index.html#makelogging"><span>The MakeLogging functor</span></a> (see also <a href="Easy_logging__Make_logging/MakeLogging/index.html"><code>Easy_logging__Make_logging.MakeLogging</code></a> )</li><li><a href="examples.html">More examples</a></li><li><a href="index.html#index"><span>Index of modules</span></a></li></ol><h3 id="description"><a href="#description" class="anchor"></a>Overall description</h3><p>The logging infrastructure is based on four concepts:</p><p><em>loggers, handlers, log items</em> and <em>logging tree</em>.</p><p>A call to <em>logger</em> will create a <em>log item</em>, which it will pass to its <em>handlers</em>. Each <em>handler</em> will treats the <em>item</em> (e.g. transform it to a string, and then outputs to stdout or to a file).</p><pre>                                     ___________
                                    | handler 1 |
               _______________      |-----------|
              |     logger    | ==&gt; |   ( * )   |
              |---------------|     |___________|
(message) ==&gt; | -&gt; log item   |      ___________
              [_______________| ==&gt; | handler 2 |
                                    |   ...     |</pre><h4 id="logging-tree"><a href="#logging-tree" class="anchor"></a>Logging tree</h4><p>Loggers are stored in a tree structure, with the following properties :</p><ul><li>messages handled by a logger (after level filtering) are passed to its ancestor's handlers (this can be overriden with the <code>set_propagate</code> method).</li><li>if not set, the level of a logger is that of its closest ancestor whose level is set (or NoLevel if there is no such ancestor)</li></ul><h5 id="example"><a href="#example" class="anchor"></a>Example</h5><pre>                       A (Info, Cli Debug)
                     /    \
                  A.B      A.C
                 /            \
            A.B.D (Warning)    A.C.E (Debug, (File &quot;f&quot;, Debug),
                                                propagate=false)</pre><p>For example, with the above logging tree</p><ul><li>logs made to <code>A</code>, <code>A.B</code> or <code>A.C</code> of level <code>Info</code> or more are written to the stdout.</li><li>logs made to <code>A.B.D</code> of level <code>Warning</code> or above are written the stdout.</li><li>logs made to <code>A.C.E</code> are only written to the file <code>&quot;f&quot;</code></li></ul><h4 id="levels"><a href="#levels" class="anchor"></a>Levels</h4><p>To each logger and log message are associated a level, which will be used to filter the messages going through the logging infrastructure.</p><p>The predefined levels are, in increasing order of precedence :</p><ol><li>Debug : used for debugging.</li><li>Trace : used between info and debug</li><li>Info : used to trace program execution.</li><li>Warning : used for warnings.</li><li>Error : used for errors.</li><li>Flash : used for one-shot debugging: displays an easy to spot message.</li><li>NoLevel : used to filter out all messages.</li></ol><h4 id="log-items"><a href="#log-items" class="anchor"></a>Log items</h4><p>A log item has type</p><pre><code class="ml">type log_item = {
    level : level;          (* the level of the log item *)
    logger_name : string;   (* the name of the logger to which the log call was passed *)
    msg : string;           (* the actual log message *)
    tags : string list      (* a list of tags *)
  } </code></pre><h3 id="handlers"><a href="#handlers" class="anchor"></a>Handlers</h3><p>Four handler creation helper function are provided. They instantiate handlers with a level of their own to filter messages :</p><ul><li><p>Cli handler: outputs colored messages to stdout.</p><pre><code class="ml">let h = Handlers.make (Cli Debug) </code></pre></li><li><p>CliErr handler: outputs colored messages to stderr.</p><pre><code class="ml">let h = Handlers.make (CliErr Debug) </code></pre></li><li><p>File handler : outputs messages to a given file.</p><pre><code class="ml">let h = Handlers.make (File (&quot;filename&quot;, Debug)) </code></pre></li><li><p>RotatingFile handler : outputs messages to a given file. Takes as argument the max number of kb per log file, and the number of backup log files.</p><pre><code class="ml">let h = Handlers.make (RotatingFile (&quot;filename&quot;, Debug, 65536, 3)) </code></pre></li></ul><p>Log file creation is governed by configuration values (setting up file name prefix/suffix, folder, file creation mode, etc...). The configuration can be specified when creating the handlers explicitely (like above), and a default configuration can be set in the Logging module.</p><p>See more at <a href="Easy_logging/Handlers/index.html"><code>Easy_logging.Handlers</code></a></p><h3 id="logger"><a href="#logger" class="anchor"></a>Loggers</h3><p>See complete class documentation at <a href="Easy_logging/Logging/class-logger/index.html"><code>Easy_logging.Logging.logger</code></a></p><h4 id="creation"><a href="#creation" class="anchor"></a>Creation</h4><p>A logger object can be created directly (in which case it will not be part of the logging tree)</p><pre><code class="ml">let logger1 = new Logging.logger &quot;my_logger1&quot; </code></pre><p>or through helper functions of the <a href="index.html#logging"><span>The Logging module</span></a> module.</p><h4 id="usage"><a href="#usage" class="anchor"></a>Usage</h4><p>A logger object has three methods for each of the log levels:</p><ul><li><p>one that takes a formatting string and parameters (printf like)</p><pre><code class="ml">logger1#debug &quot;Myvar : %s&quot; (to_string myvar); </code></pre></li><li><p>one that takes a <code>string lazy_t</code></p><pre><code class="ml">logger1#ldebug (lazy (heavy_calculation ())); </code></pre></li><li><p>one that takes a <code>string</code></p><pre><code class="ml">logger1#sdebug (to_string myvar);</code></pre></li></ul><h3 id="logging"><a href="#logging" class="anchor"></a>The Logging module</h3><p>The <a href="Easy_logging/Logging/index.html"><code>Easy_logging.Logging</code></a> module is the application of <code>MakeLogging</code> over <code>Handlers</code>. It provides two functions :</p><ul><li><pre><code class="ml">val make_logger :
   ?propagate:bool -&gt; string -&gt; log_level -&gt; Handlers.desc list </code></pre><p>Instantiates a logger with some paramters, and adds it to the logging tree.</p></li></ul><ul><li><pre><code class="ml">val get_logger : string -&gt; logger </code></pre><p>Returns a registered logger, or creates a new one if it doesn't exist.</p></li></ul><ul><li><pre><code class="ml">val set_handlers_config : Handlers.config -&gt; unit</code></pre><p>Sets the default handlers configuration, used when creating new handlers via <code>make_logger</code>.</p></li></ul><h3 id="makelogging"><a href="#makelogging" class="anchor"></a>The MakeLogging functor</h3><p>The MakeLogging functor takes a <span class="xref-unresolved" title="unresolved reference to &quot;Easy_logging__.Easy_logging_types.HandlersT&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Easy_logging__.Easy_logging_types&quot;"><a href="Easy_logging__/index.html"><code>Easy_logging__</code></a>.Easy_logging_types</span>.HandlersT</span> typed module, and creates a Logging module.</p><h4 id="warning"><a href="#warning" class="anchor"></a>WARNING</h4><p>When declaring your Handlers module, do not coerce it the type <code>HandlersT</code>, because then its internal types <code>t</code> and <code>desc</code> won't be accessible.</p><h3 id="examples"><a href="#examples" class="anchor"></a>Examples</h3><p>See <a href="examples.html">the examples page</a> for more examples.</p><h3 id="index"><a href="#index" class="anchor"></a>Index of modules</h3><ol><li><a href="Easy_logging__Colorize/index.html"><code>Easy_logging__Colorize</code></a></li><li><a href="Easy_logging/index.html"><code>Easy_logging</code></a></li><li><a href="Easy_logging__Formatters/index.html"><code>Easy_logging__Formatters</code></a></li><li><a href="Easy_logging__Handlers/index.html"><code>Easy_logging__Handlers</code></a></li><li><a href="Easy_logging__Logging_infra/index.html"><code>Easy_logging__Logging_infra</code></a></li><li><a href="Easy_logging__Logging_types/index.html"><code>Easy_logging__Logging_types</code></a></li><li><a href="Easy_logging__Make_logging/index.html"><code>Easy_logging__Make_logging</code></a></li></ol></div></body></html>